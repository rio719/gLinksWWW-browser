<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Cookie Value</title>
    <style>
        body { background: #000; color: #fff; font-family: monospace; padding: 20px; }
        textarea { background: #222; color: #0f0; border: 1px solid #444; width: 100%; padding: 10px; margin-bottom: 10px; }
        button { background: #444; color: #fff; border: none; padding: 10px 20px; cursor: pointer; }
        button:hover { background: #666; }
        #cookieNameDisplay { font-size: 0.9em; color: #aaa; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div id="cookieNameDisplay">Loading info...</div>

    <textarea id="cookievalue" rows="15"></textarea>
    <br>
    <button onclick="saveCookie()">Save</button>
    <button onclick="history.back()">Cancel</button>

    <script>
        // 1. ì¼ë ‰íŠ¸ë¡ ì˜ ipcRendererë¥¼ ì§ì ‘ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
    const { ipcRenderer } = require('electron');

    const urlParams = new URLSearchParams(window.location.search);
    const domain = urlParams.get('domain');
    const name = urlParams.get('name');

        // ìƒë‹¨ ì •ë³´ í‘œì‹œ
        if (domain && name) {
            document.getElementById('cookieNameDisplay').innerText = `Editing: ${name} \nDomain: ${domain}`;
        }

     async function loadCookieValue() {
        const textArea = document.getElementById('cookievalue');
        try {
            // 2. window.electronAPI ëŒ€ì‹  ipcRenderer.invokeë¥¼ ì§ì ‘ í˜¸ì¶œ!
            const value = await ipcRenderer.invoke('get-cookie-value', { domain, name });
            textArea.value = value || "";
        } catch (error) {
            console.error('Load error:', error);
            textArea.value = "Error: " + error.message; 
        }
    }

    async function saveCookie() {
        const newValue = document.getElementById('cookievalue').value;
        try {
            // 3. ë§ˆì°¬ê°€ì§€ë¡œ ì§ì ‘ í˜¸ì¶œ!
            const success = await ipcRenderer.invoke('save-cookie', {
                domain: domain,
                name: name,
                value: newValue
            });

            if (success) {
                alert('Cookie saved successfully! ğŸ˜');
                window.location.href = 'cookie.html'; 
            } else {
                alert('Failed to save cookie. ğŸ˜¢');
            }
        } catch (error) {
            console.error('Save error:', error);
            alert('An error occurred while saving.');
        }
    }

    loadCookieValue();
    </script>
</body>
</html>